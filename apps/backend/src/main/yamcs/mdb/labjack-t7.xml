<?xml version="1.0" encoding="UTF-8"?>
<SpaceSystem name="LabJackT7"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.omg.org/spec/XTCE/20180204"
             xsi:schemaLocation="https://www.omg.org/spec/XTCE/20180204/SpaceSystem.xsd ">
    <TelemetryMetaData>
        <ParameterTypeSet>
            <EnumeratedParameterType name="digital_pin_state">
                <UnitSet/>
                <IntegerDataEncoding encoding="unsigned" sizeInBits="1"/>
                <EnumerationList>
                    <Enumeration value="0" label="low"/>
                    <Enumeration value="1" label="high"/>
                </EnumerationList>
            </EnumeratedParameterType>

            <FloatParameterType name="float_32">
                <FloatDataEncoding encoding="IEEE754_1985"/>
            </FloatParameterType>
        </ParameterTypeSet>
        <ParameterSet>
            <Parameter name="AIN79" parameterTypeRef="float_32"/>
            <Parameter name="AIN80" parameterTypeRef="float_32"/>
            <Parameter name="AIN81" parameterTypeRef="float_32"/>
            <Parameter name="AIN82" parameterTypeRef="float_32"/>
            <Parameter name="AIN83" parameterTypeRef="float_32"/>
            <Parameter name="AIN84" parameterTypeRef="float_32"/>
            <Parameter name="AIN85" parameterTypeRef="float_32"/>
            <Parameter name="AIN86" parameterTypeRef="float_32"/>
            <Parameter name="AIN87" parameterTypeRef="float_32"/>
            <Parameter name="AIN88" parameterTypeRef="float_32"/>
            <Parameter name="AIN89" parameterTypeRef="float_32"/>
            <Parameter name="AIN90" parameterTypeRef="float_32"/>
            <Parameter name="AIN91" parameterTypeRef="float_32"/>
            <Parameter name="AIN92" parameterTypeRef="float_32"/>
            <Parameter name="AIN93" parameterTypeRef="float_32"/>
            <Parameter name="AIN94" parameterTypeRef="float_32"/>
            <Parameter name="AIN95" parameterTypeRef="float_32"/>
            <Parameter name="AIN96" parameterTypeRef="float_32"/>
            <Parameter name="AIN97" parameterTypeRef="float_32"/>
            <Parameter name="AIN98" parameterTypeRef="float_32"/>
            <Parameter name="AIN99" parameterTypeRef="float_32"/>
            <Parameter name="AIN100" parameterTypeRef="float_32"/>
            <Parameter name="AIN101" parameterTypeRef="float_32"/>
            <Parameter name="AIN102" parameterTypeRef="float_32"/>
            <Parameter name="AIN103" parameterTypeRef="float_32"/>
            <Parameter name="AIN104" parameterTypeRef="float_32"/>
            <Parameter name="AIN105" parameterTypeRef="float_32"/>
            <Parameter name="AIN106" parameterTypeRef="float_32"/>
            <Parameter name="AIN107" parameterTypeRef="float_32"/>
            <Parameter name="AIN108" parameterTypeRef="float_32"/>
            <Parameter name="AIN109" parameterTypeRef="float_32"/>
            <Parameter name="AIN110" parameterTypeRef="float_32"/>
            <Parameter name="AIN111" parameterTypeRef="float_32"/>
            <Parameter name="AIN112" parameterTypeRef="float_32"/>
            <Parameter name="AIN113" parameterTypeRef="float_32"/>
            <Parameter name="AIN114" parameterTypeRef="float_32"/>
            <Parameter name="AIN115" parameterTypeRef="float_32"/>
            <Parameter name="AIN116" parameterTypeRef="float_32"/>
            <Parameter name="AIN117" parameterTypeRef="float_32"/>
            <Parameter name="AIN118" parameterTypeRef="float_32"/>
            <Parameter name="AIN119" parameterTypeRef="float_32"/>
            <Parameter name="AIN120" parameterTypeRef="float_32"/>
            <Parameter name="AIN121" parameterTypeRef="float_32"/>
            <Parameter name="AIN122" parameterTypeRef="float_32"/>
            <Parameter name="AIN123" parameterTypeRef="float_32"/>

            <Parameter name="FIO0" parameterTypeRef="digital_pin_state"/>
            <Parameter name="FIO1" parameterTypeRef="digital_pin_state"/>
            <Parameter name="FIO2" parameterTypeRef="digital_pin_state"/>
            <Parameter name="FIO3" parameterTypeRef="digital_pin_state"/>
            <Parameter name="FIO4" parameterTypeRef="digital_pin_state"/>
            <Parameter name="FIO5" parameterTypeRef="digital_pin_state"/>
            <Parameter name="FIO6" parameterTypeRef="digital_pin_state"/>
            <Parameter name="FIO7" parameterTypeRef="digital_pin_state"/>

            <Parameter name="EIO0" parameterTypeRef="digital_pin_state"/>
            <Parameter name="EIO1" parameterTypeRef="digital_pin_state"/>
            <Parameter name="EIO2" parameterTypeRef="digital_pin_state"/>
            <Parameter name="EIO3" parameterTypeRef="digital_pin_state"/>
            <Parameter name="EIO4" parameterTypeRef="digital_pin_state"/>
            <Parameter name="EIO5" parameterTypeRef="digital_pin_state"/>
            <Parameter name="EIO6" parameterTypeRef="digital_pin_state"/>
            <Parameter name="EIO7" parameterTypeRef="digital_pin_state"/>

            <Parameter name="CIO0" parameterTypeRef="digital_pin_state"/>
            <Parameter name="CIO1" parameterTypeRef="digital_pin_state"/>
            <Parameter name="CIO2" parameterTypeRef="digital_pin_state"/>
            <Parameter name="CIO3" parameterTypeRef="digital_pin_state"/>

            <Parameter name="MIO0" parameterTypeRef="digital_pin_state"/>
            <Parameter name="MIO1" parameterTypeRef="digital_pin_state"/>
            <Parameter name="MIO2" parameterTypeRef="digital_pin_state"/>


            <Parameter name="calibrated_fill_pressure_psi" parameterTypeRef="float_32">
                <ParameterProperties dataSource="derived" readOnly="true">
                </ParameterProperties>
            </Parameter>
            <Parameter name="calibrated_purge_pressure_psi" parameterTypeRef="float_32">
                <ParameterProperties dataSource="derived" readOnly="true">
                </ParameterProperties>
            </Parameter>
            <Parameter name="calibrated_tank_pressure_psi" parameterTypeRef="float_32">
                <ParameterProperties dataSource="derived" readOnly="true">
                </ParameterProperties>
            </Parameter>
            <Parameter name="calibrated_run_pressure_psi" parameterTypeRef="float_32">
                <ParameterProperties dataSource="derived" readOnly="true">
                </ParameterProperties>
            </Parameter>
            <Parameter name="calibrated_thrust_newtons" parameterTypeRef="float_32">
                <ParameterProperties dataSource="derived" readOnly="true">
                </ParameterProperties>
            </Parameter>
            <Parameter name="calibrated_tank_mass" parameterTypeRef="float_32">
                <ParameterProperties dataSource="derived" readOnly="true">
                </ParameterProperties>
            </Parameter>
        </ParameterSet>
        <ContainerSet>
            <SequenceContainer name="LabJackPacket">
                <EntryList>
                    <ParameterRefEntry parameterRef="AIN79"/>
                    <ParameterRefEntry parameterRef="AIN80"/>
                    <ParameterRefEntry parameterRef="AIN81"/>
                    <ParameterRefEntry parameterRef="AIN82"/>
                    <ParameterRefEntry parameterRef="AIN83"/>
                    <ParameterRefEntry parameterRef="AIN84"/>
                    <ParameterRefEntry parameterRef="AIN85"/>
                    <ParameterRefEntry parameterRef="AIN86"/>
                    <ParameterRefEntry parameterRef="AIN87"/>
                    <ParameterRefEntry parameterRef="AIN88"/>
                    <ParameterRefEntry parameterRef="AIN89"/>
                    <ParameterRefEntry parameterRef="AIN90"/>
                    <ParameterRefEntry parameterRef="AIN91"/>
                    <ParameterRefEntry parameterRef="AIN92"/>
                    <ParameterRefEntry parameterRef="AIN93"/>
                    <ParameterRefEntry parameterRef="AIN94"/>
                    <ParameterRefEntry parameterRef="AIN95"/>
                    <ParameterRefEntry parameterRef="AIN96"/>
                    <ParameterRefEntry parameterRef="AIN97"/>
                    <ParameterRefEntry parameterRef="AIN98"/>
                    <ParameterRefEntry parameterRef="AIN99"/>
                    <ParameterRefEntry parameterRef="AIN100"/>
                    <ParameterRefEntry parameterRef="AIN101"/>
                    <ParameterRefEntry parameterRef="AIN102"/>
                    <ParameterRefEntry parameterRef="AIN103"/>
                    <ParameterRefEntry parameterRef="AIN104"/>
                    <ParameterRefEntry parameterRef="AIN105"/>
                    <ParameterRefEntry parameterRef="AIN106"/>
                    <ParameterRefEntry parameterRef="AIN107"/>
                    <ParameterRefEntry parameterRef="AIN108"/>
                    <ParameterRefEntry parameterRef="AIN109"/>
                    <ParameterRefEntry parameterRef="AIN110"/>
                    <ParameterRefEntry parameterRef="AIN111"/>
                    <ParameterRefEntry parameterRef="AIN112"/>
                    <ParameterRefEntry parameterRef="AIN113"/>
                    <ParameterRefEntry parameterRef="AIN114"/>
                    <ParameterRefEntry parameterRef="AIN115"/>
                    <ParameterRefEntry parameterRef="AIN116"/>
                    <ParameterRefEntry parameterRef="AIN117"/>
                    <ParameterRefEntry parameterRef="AIN118"/>
                    <ParameterRefEntry parameterRef="AIN119"/>
                    <ParameterRefEntry parameterRef="AIN120"/>
                    <ParameterRefEntry parameterRef="AIN121"/>
                    <ParameterRefEntry parameterRef="AIN122"/>
                    <ParameterRefEntry parameterRef="AIN123"/>

                    <ParameterRefEntry parameterRef="FIO0"/>
                    <ParameterRefEntry parameterRef="FIO1"/>
                    <ParameterRefEntry parameterRef="FIO2"/>
                    <ParameterRefEntry parameterRef="FIO3"/>
                    <ParameterRefEntry parameterRef="FIO4"/>
                    <ParameterRefEntry parameterRef="FIO5"/>
                    <ParameterRefEntry parameterRef="FIO6"/>
                    <ParameterRefEntry parameterRef="FIO7"/>

                    <ParameterRefEntry parameterRef="EIO0"/>
                    <ParameterRefEntry parameterRef="EIO1"/>
                    <ParameterRefEntry parameterRef="EIO2"/>
                    <ParameterRefEntry parameterRef="EIO3"/>
                    <ParameterRefEntry parameterRef="EIO4"/>
                    <ParameterRefEntry parameterRef="EIO5"/>
                    <ParameterRefEntry parameterRef="EIO6"/>
                    <ParameterRefEntry parameterRef="EIO7"/>

                    <ParameterRefEntry parameterRef="CIO0"/>
                    <ParameterRefEntry parameterRef="CIO1"/>
                    <ParameterRefEntry parameterRef="CIO2"/>
                    <ParameterRefEntry parameterRef="CIO3"/>

                    <ParameterRefEntry parameterRef="MIO0"/>
                    <ParameterRefEntry parameterRef="MIO1"/>
                    <ParameterRefEntry parameterRef="MIO2"/>
                </EntryList>
            </SequenceContainer>
        </ContainerSet>
        <AlgorithmSet>
            <MathAlgorithm name="calibrated_fill_pressure_psi">
                <MathOperation outputParameterRef="calibrated_fill_pressure_psi">
                    <ParameterInstanceRefOperand parameterRef="AIN88"/>
                    <ValueOperand>611</ValueOperand>
                    <Operator>*</Operator>
                    <ValueOperand>475</ValueOperand>
                    <Operator>-</Operator>
                    <TriggerSet>
                        <OnParameterUpdateTrigger parameterRef="AIN88"/>
                    </TriggerSet>
                </MathOperation>
            </MathAlgorithm>
            <MathAlgorithm name="calibrated_purge_pressure_psi">
                <MathOperation outputParameterRef="calibrated_purge_pressure_psi">
                    <ParameterInstanceRefOperand parameterRef="AIN90"/>
                    <ValueOperand>611</ValueOperand>
                    <Operator>*</Operator>
                    <ValueOperand>460</ValueOperand>
                    <Operator>-</Operator>
                    <TriggerSet>
                        <OnParameterUpdateTrigger parameterRef="AIN90"/>
                    </TriggerSet>
                </MathOperation>
            </MathAlgorithm>
            <MathAlgorithm name="calibrated_tank_pressure_psi">
                <MathOperation outputParameterRef="calibrated_tank_pressure_psi">
                    <ParameterInstanceRefOperand parameterRef="AIN121"/>
                    <ValueOperand>611</ValueOperand>
                    <Operator>*</Operator>
                    <ValueOperand>500  </ValueOperand>
                    <Operator>-</Operator>
                    <TriggerSet>
                        <OnParameterUpdateTrigger parameterRef="AIN121"/>
                    </TriggerSet>
                </MathOperation>
            </MathAlgorithm>
            <MathAlgorithm name="calibrated_run_pressure_psi">
                <MathOperation outputParameterRef="calibrated_run_pressure_psi">
                    <ParameterInstanceRefOperand parameterRef="AIN122"/>
                    <ValueOperand>611</ValueOperand>
                    <Operator>*</Operator>
                    <ValueOperand>513</ValueOperand>
                    <Operator>-</Operator>
                    <TriggerSet>
                        <OnParameterUpdateTrigger parameterRef="AIN122"/>
                    </TriggerSet>
                </MathOperation>
            </MathAlgorithm>
            <MathAlgorithm name="calibrated_thrust_newtons">
                <MathOperation outputParameterRef="calibrated_thrust_newtons">
                    <ParameterInstanceRefOperand parameterRef="AIN87"/>
                    <ValueOperand>23236</ValueOperand>
                    <Operator>*</Operator>
                    <ValueOperand>2324</ValueOperand>
                    <Operator>-</Operator>
                    <TriggerSet>
                        <OnParameterUpdateTrigger parameterRef="AIN87"/>
                    </TriggerSet>
                </MathOperation>
            </MathAlgorithm>
            <MathAlgorithm name="calibrated_tank_mass">
                <MathOperation outputParameterRef="calibrated_tank_mass">
                    <ParameterInstanceRefOperand parameterRef="AIN82"/>
                    <ValueOperand>28.22</ValueOperand>
                    <Operator>*</Operator>
                    <ValueOperand>0</ValueOperand>
                    <Operator>-</Operator>
                    <TriggerSet>
                        <OnParameterUpdateTrigger parameterRef="AIN82"/>
                    </TriggerSet>
                </MathOperation>
            </MathAlgorithm>
        </AlgorithmSet>
    </TelemetryMetaData>
    <CommandMetaData>
        <ArgumentTypeSet>
            <EnumeratedArgumentType name="digital_pin_state">
                <IntegerDataEncoding sizeInBits="1"/>
                <EnumerationList>
                    <Enumeration value="0" label="LOW"/>
                    <Enumeration value="1" label="HIGH"/>
                </EnumerationList>
            </EnumeratedArgumentType>
            <FloatArgumentType name="DAC_voltage">
                <UnitSet>
                    <Unit>V</Unit>
                </UnitSet>
                <FloatDataEncoding/>
                <ValidRangeSet>
                    <ValidRange minInclusive="0.00" maxInclusive="5.00"/>
                </ValidRangeSet>
            </FloatArgumentType>
            <IntegerArgumentType name="digital_pin_number" signed="false" sizeInBits="8">
                <IntegerDataEncoding/>
                <ValidRangeSet>
                    <ValidRange minInclusive="0" maxInclusive="22"/>
                </ValidRangeSet>
            </IntegerArgumentType>
            <IntegerArgumentType name="DAC_pin_number" signed="false" sizeInBits="8">
                <IntegerDataEncoding/>
                <ValidRangeSet>
                    <ValidRange minInclusive="0" maxInclusive="1"/>
                </ValidRangeSet>
            </IntegerArgumentType>
        </ArgumentTypeSet>
        <MetaCommandSet>
            <MetaCommand name="write_digital_pin">
                <ArgumentList>
                    <Argument name="pin_number" argumentTypeRef="digital_pin_number" shortDescription="Pin number of the digital pin (0-22)"/>
                    <Argument name="pin_state" argumentTypeRef="digital_pin_state" shortDescription="State to write to digital pin (HIGH/LOW)"/>
                </ArgumentList>
                <CommandContainer name="write_digital_pin">
                    <EntryList>
                        <ArgumentRefEntry argumentRef="pin_state"/>
                        <ArgumentRefEntry argumentRef="pin_number"/>
                    </EntryList>
                </CommandContainer>
            </MetaCommand>
            <MetaCommand name="write_DAC_pin">
                <ArgumentList>
                    <Argument name="pin_number" argumentTypeRef="DAC_pin_number" shortDescription="Pin number of the DAC pin (0-1)"/>
                    <Argument name="pin_voltage" argumentTypeRef="DAC_voltage" shortDescription="Voltage to set DAC pin to (0-5)"/>
                </ArgumentList>
                <CommandContainer name="write_DAC_pin">
                    <EntryList>
                        <ArgumentRefEntry argumentRef="pin_voltage"/>
                        <ArgumentRefEntry argumentRef="pin_number"/>
                    </EntryList>
                </CommandContainer>
            </MetaCommand>
        </MetaCommandSet>
    </CommandMetaData>
</SpaceSystem>
